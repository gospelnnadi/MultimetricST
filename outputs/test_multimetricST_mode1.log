/home/accounts/personale/nndgpl46/miniconda3/envs/MMST/lib/python3.10/site-packages/louvain/__init__.py:54: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import get_distribution, DistributionNotFound
The current working dir is,  /storage-large/homedirs/nndgpl46/MultimetricST
Running full pipeline: clustering → evaluation → dashboard visualization
dir_path: Data/DLPFC/
name: 151673
/home/accounts/personale/nndgpl46/miniconda3/envs/MMST/lib/python3.10/site-packages/anndata/_core/anndata.py:1756: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
/home/accounts/personale/nndgpl46/miniconda3/envs/MMST/lib/python3.10/site-packages/anndata/_core/anndata.py:1756: UserWarning: Variable names are not unique. To make them unique, call `.var_names_make_unique`.
  utils.warn_names_duplicates("var")
adata_raw dim (3639, 33538)
gound_truth dim (3639, 1)
Running Mode 1: Full pipeline
✅ Skipping CCST (already exists)
✅ Skipping SpaGCN (already exists)
✅ Skipping conST (already exists)
✅ Skipping DeepST (already exists)
✅ Skipping STAGATE_pyG (already exists)
✅ Skipping SEDR (already exists)
✅ Skipping SCAN-IT (already exists)
✅ Skipping GraphST (already exists)
✅ Skipping SpaceFlow (already exists)
✅ Skipping GIST (already exists)
✨ All repositories processed!
Warning: the binary library cannot be imported. You cannot train maps, but you can load and analyze ones that you have already saved.
The problem occurs because either compilation failed when you installed Somoclu or a path is missing from the dependencies when you are trying to import it. Please refer to the documentation to see your options.
Using device: cpu
Running clustering pipeline...


Running CCST...





AnnData object with n_obs × n_vars = 3639 × 33538
    obs: 'in_tissue', 'array_row', 'array_col', 'ground_truth'
    var: 'gene_ids', 'feature_types', 'genome'
    uns: 'spatial'
    obsm: 'spatial'
===== Preprocessing Data 
calculating distance matrix, it takes a while
300 62436 8.578730420445178
------------------------Model and Training Details--------------------------
Namespace(min_cells=5, Dim_PCA=200, data_name='151673', generated_data_path='generated_data/', lambda_I=0.3, data_path='generated_data/', model_path='model/151673/', embedding_data_path='Embedding_data/151673/', result_path='results/151673/lambdaI0.3/', DGI=1, load=0, num_epoch=5000, hidden=256, PCA=1, cluster=1, n_clusters=7, draw_map=1, diff_gene=0)
Adj: (3639, 3639) Edges: 66075
X: (3639, 200)
-----------Deep Graph Infomax-------------
Epoch: 100, Loss: 1.9094
Epoch: 200, Loss: 1.5111
Epoch: 300, Loss: 1.2082
Epoch: 400, Loss: 1.1734
Epoch: 500, Loss: 0.9913
Epoch: 600, Loss: 0.9011
Epoch: 700, Loss: 0.7657
Epoch: 800, Loss: 0.7051
Epoch: 900, Loss: 0.6942
Epoch: 1000, Loss: 0.5824
Epoch: 1100, Loss: 0.5523
Epoch: 1200, Loss: 0.5289
Epoch: 1300, Loss: 0.4821
Epoch: 1400, Loss: 0.4568
Epoch: 1500, Loss: 0.3783
Epoch: 1600, Loss: 0.3703
Epoch: 1700, Loss: 0.3577
Epoch: 1800, Loss: 0.3090
Epoch: 1900, Loss: 0.2850
Epoch: 2000, Loss: 0.2512
Epoch: 2100, Loss: 0.2447
Epoch: 2200, Loss: 0.2317
Epoch: 2300, Loss: 0.2140
Epoch: 2400, Loss: 0.2146
Epoch: 2500, Loss: 0.2029
Epoch: 2600, Loss: 0.1746
Epoch: 2700, Loss: 0.1897
Epoch: 2800, Loss: 0.1582
Epoch: 2900, Loss: 0.1625
Epoch: 3000, Loss: 0.1537
Epoch: 3100, Loss: 0.1436
Epoch: 3200, Loss: 0.1229
Epoch: 3300, Loss: 0.1199
Epoch: 3400, Loss: 0.1303
Epoch: 3500, Loss: 0.0927
Epoch: 3600, Loss: 0.1234
Epoch: 3700, Loss: 0.0971
Epoch: 3800, Loss: 0.0959
Epoch: 3900, Loss: 0.0942
Epoch: 4000, Loss: 0.0747
Epoch: 4100, Loss: 0.0723
Epoch: 4200, Loss: 0.0690
Epoch: 4300, Loss: 0.0609
Epoch: 4400, Loss: 0.0590
Epoch: 4500, Loss: 0.0665
Epoch: 4600, Loss: 0.0564
Epoch: 4700, Loss: 0.0544
Epoch: 4800, Loss: 0.0514
Epoch: 4900, Loss: 0.0608
Epoch: 5000, Loss: 0.0722
Training time in seconds:  745
Execution time: 912.1632 seconds
Current memory usage: 220.1561 MB
Peak memory usage: 1386.8178 MB
-----------Clustering-------------


Running conST...





===== Preprocessing Data 
Pretraining stage:  |                                | 1 / 200 | Left time: 0.84 mins| Loss: 155.4177Pretraining stage:  |                                | 2 / 200 | Left time: 0.24 mins| Loss: 151.9018Pretraining stage:  |                                | 3 / 200 | Left time: 0.23 mins| Loss: 149.6975Pretraining stage:  |                                | 4 / 200 | Left time: 0.23 mins| Loss: 147.9822Pretraining stage:  |                                | 5 / 200 | Left time: 0.22 mins| Loss: 146.9539Pretraining stage:  |                                | 6 / 200 | Left time: 0.22 mins| Loss: 146.0038Pretraining stage:  |#                               | 7 / 200 | Left time: 0.22 mins| Loss: 145.6851Pretraining stage:  |#                               | 8 / 200 | Left time: 0.22 mins| Loss: 144.6060Pretraining stage:  |#                               | 9 / 200 | Left time: 0.22 mins| Loss: 144.4770Pretraining stage:  |#                               | 10 / 200 | Left time: 0.22 mins| Loss: 143.7837Pretraining stage:  |#                               | 11 / 200 | Left time: 0.21 mins| Loss: 143.3249Pretraining stage:  |#                               | 12 / 200 | Left time: 0.22 mins| Loss: 143.2023Pretraining stage:  |##                              | 13 / 200 | Left time: 0.21 mins| Loss: 142.6647Pretraining stage:  |##                              | 14 / 200 | Left time: 0.21 mins| Loss: 142.7523Pretraining stage:  |##                              | 15 / 200 | Left time: 0.21 mins| Loss: 142.2336Pretraining stage:  |##                              | 16 / 200 | Left time: 0.21 mins| Loss: 142.4044Pretraining stage:  |##                              | 17 / 200 | Left time: 0.21 mins| Loss: 142.3543Pretraining stage:  |##                              | 18 / 200 | Left time: 0.21 mins| Loss: 141.9866Pretraining stage:  |###                             | 19 / 200 | Left time: 0.21 mins| Loss: 141.4509Pretraining stage:  |###                             | 20 / 200 | Left time: 0.20 mins| Loss: 141.2930Pretraining stage:  |###                             | 21 / 200 | Left time: 0.20 mins| Loss: 141.1671Pretraining stage:  |###                             | 22 / 200 | Left time: 0.20 mins| Loss: 140.9512Pretraining stage:  |###                             | 23 / 200 | Left time: 0.20 mins| Loss: 141.2451Pretraining stage:  |###                             | 24 / 200 | Left time: 0.20 mins| Loss: 140.8147Pretraining stage:  |####                            | 25 / 200 | Left time: 0.20 mins| Loss: 141.2279Pretraining stage:  |####                            | 26 / 200 | Left time: 0.20 mins| Loss: 140.5081Pretraining stage:  |####                            | 27 / 200 | Left time: 0.20 mins| Loss: 140.8761Pretraining stage:  |####                            | 28 / 200 | Left time: 0.19 mins| Loss: 140.7016Pretraining stage:  |####                            | 29 / 200 | Left time: 0.19 mins| Loss: 140.5171Pretraining stage:  |####                            | 30 / 200 | Left time: 0.20 mins| Loss: 140.2682Pretraining stage:  |####                            | 31 / 200 | Left time: 0.19 mins| Loss: 140.0666Pretraining stage:  |#####                           | 32 / 200 | Left time: 0.19 mins| Loss: 140.5398Pretraining stage:  |#####                           | 33 / 200 | Left time: 0.19 mins| Loss: 140.1302Pretraining stage:  |#####                           | 34 / 200 | Left time: 0.19 mins| Loss: 139.8674Pretraining stage:  |#####                           | 35 / 200 | Left time: 0.19 mins| Loss: 139.4915Pretraining stage:  |#####                           | 36 / 200 | Left time: 0.18 mins| Loss: 139.1123Pretraining stage:  |#####                           | 37 / 200 | Left time: 0.19 mins| Loss: 139.4954Pretraining stage:  |######                          | 38 / 200 | Left time: 0.18 mins| Loss: 139.3971Pretraining stage:  |######                          | 39 / 200 | Left time: 0.18 mins| Loss: 139.3740Pretraining stage:  |######                          | 40 / 200 | Left time: 0.18 mins| Loss: 139.8701Pretraining stage:  |######                          | 41 / 200 | Left time: 0.18 mins| Loss: 139.2971Pretraining stage:  |######                          | 42 / 200 | Left time: 0.18 mins| Loss: 139.5394Pretraining stage:  |######                          | 43 / 200 | Left time: 0.18 mins| Loss: 139.5482Pretraining stage:  |#######                         | 44 / 200 | Left time: 0.18 mins| Loss: 139.2614Pretraining stage:  |#######                         | 45 / 200 | Left time: 0.18 mins| Loss: 139.2338Pretraining stage:  |#######                         | 46 / 200 | Left time: 0.17 mins| Loss: 138.8731Pretraining stage:  |#######                         | 47 / 200 | Left time: 0.17 mins| Loss: 139.1704Pretraining stage:  |#######                         | 48 / 200 | Left time: 0.17 mins| Loss: 138.5769Pretraining stage:  |#######                         | 49 / 200 | Left time: 0.18 mins| Loss: 139.0753Pretraining stage:  |########                        | 50 / 200 | Left time: 0.17 mins| Loss: 138.1230Pretraining stage:  |########                        | 51 / 200 | Left time: 0.17 mins| Loss: 138.4513Pretraining stage:  |########                        | 52 / 200 | Left time: 0.17 mins| Loss: 138.3435Pretraining stage:  |########                        | 53 / 200 | Left time: 0.17 mins| Loss: 138.7278Pretraining stage:  |########                        | 54 / 200 | Left time: 0.17 mins| Loss: 138.1467Pretraining stage:  |########                        | 55 / 200 | Left time: 0.16 mins| Loss: 138.4559Pretraining stage:  |########                        | 56 / 200 | Left time: 0.16 mins| Loss: 138.1278Pretraining stage:  |#########                       | 57 / 200 | Left time: 0.16 mins| Loss: 138.2639Pretraining stage:  |#########                       | 58 / 200 | Left time: 0.16 mins| Loss: 138.4577Pretraining stage:  |#########                       | 59 / 200 | Left time: 0.16 mins| Loss: 138.9141Pretraining stage:  |#########                       | 60 / 200 | Left time: 0.16 mins| Loss: 137.9885Pretraining stage:  |#########                       | 61 / 200 | Left time: 0.16 mins| Loss: 138.5185Pretraining stage:  |#########                       | 62 / 200 | Left time: 0.16 mins| Loss: 137.9849Pretraining stage:  |##########                      | 63 / 200 | Left time: 0.16 mins| Loss: 138.4861Pretraining stage:  |##########                      | 64 / 200 | Left time: 0.16 mins| Loss: 138.4393Pretraining stage:  |##########                      | 65 / 200 | Left time: 0.16 mins| Loss: 137.0935Pretraining stage:  |##########                      | 66 / 200 | Left time: 0.15 mins| Loss: 138.1075Pretraining stage:  |##########                      | 67 / 200 | Left time: 0.15 mins| Loss: 137.3878Pretraining stage:  |##########                      | 68 / 200 | Left time: 0.15 mins| Loss: 137.7730Pretraining stage:  |###########                     | 69 / 200 | Left time: 0.15 mins| Loss: 137.8281Pretraining stage:  |###########                     | 70 / 200 | Left time: 0.15 mins| Loss: 137.1344Pretraining stage:  |###########                     | 71 / 200 | Left time: 0.15 mins| Loss: 137.7509Pretraining stage:  |###########                     | 72 / 200 | Left time: 0.15 mins| Loss: 138.3175Pretraining stage:  |###########                     | 73 / 200 | Left time: 0.15 mins| Loss: 137.5748Pretraining stage:  |###########                     | 74 / 200 | Left time: 0.14 mins| Loss: 137.4737Pretraining stage:  |############                    | 75 / 200 | Left time: 0.14 mins| Loss: 138.3743Pretraining stage:  |############                    | 76 / 200 | Left time: 0.14 mins| Loss: 136.9484Pretraining stage:  |############                    | 77 / 200 | Left time: 0.14 mins| Loss: 136.7451Pretraining stage:  |############                    | 78 / 200 | Left time: 0.14 mins| Loss: 136.7161Pretraining stage:  |############                    | 79 / 200 | Left time: 0.14 mins| Loss: 137.3915Pretraining stage:  |############                    | 80 / 200 | Left time: 0.14 mins| Loss: 138.0873Pretraining stage:  |############                    | 81 / 200 | Left time: 0.14 mins| Loss: 137.5042Pretraining stage:  |#############                   | 82 / 200 | Left time: 0.13 mins| Loss: 136.9267Pretraining stage:  |#############                   | 83 / 200 | Left time: 0.13 mins| Loss: 137.0156Pretraining stage:  |#############                   | 84 / 200 | Left time: 0.13 mins| Loss: 136.7445Pretraining stage:  |#############                   | 85 / 200 | Left time: 0.13 mins| Loss: 137.4602Pretraining stage:  |#############                   | 86 / 200 | Left time: 0.13 mins| Loss: 136.4888Pretraining stage:  |#############                   | 87 / 200 | Left time: 0.13 mins| Loss: 136.5385Pretraining stage:  |##############                  | 88 / 200 | Left time: 0.13 mins| Loss: 136.9416Pretraining stage:  |##############                  | 89 / 200 | Left time: 0.13 mins| Loss: 136.4960Pretraining stage:  |##############                  | 90 / 200 | Left time: 0.12 mins| Loss: 137.4449Pretraining stage:  |##############                  | 91 / 200 | Left time: 0.13 mins| Loss: 137.1167Pretraining stage:  |##############                  | 92 / 200 | Left time: 0.12 mins| Loss: 136.8756Pretraining stage:  |##############                  | 93 / 200 | Left time: 0.12 mins| Loss: 136.7655Pretraining stage:  |###############                 | 94 / 200 | Left time: 0.12 mins| Loss: 136.6676Pretraining stage:  |###############                 | 95 / 200 | Left time: 0.12 mins| Loss: 136.5597Pretraining stage:  |###############                 | 96 / 200 | Left time: 0.12 mins| Loss: 136.3236Pretraining stage:  |###############                 | 97 / 200 | Left time: 0.12 mins| Loss: 137.1088Pretraining stage:  |###############                 | 98 / 200 | Left time: 0.12 mins| Loss: 136.8312Pretraining stage:  |###############                 | 99 / 200 | Left time: 0.12 mins| Loss: 136.2598Pretraining stage:  |################                | 100 / 200 | Left time: 0.11 mins| Loss: 136.5718Pretraining stage:  |################                | 101 / 200 | Left time: 0.11 mins| Loss: 136.1421Pretraining stage:  |################                | 102 / 200 | Left time: 0.11 mins| Loss: 136.3898Pretraining stage:  |################                | 103 / 200 | Left time: 0.11 mins| Loss: 135.8828Pretraining stage:  |################                | 104 / 200 | Left time: 0.11 mins| Loss: 136.0218Pretraining stage:  |################                | 105 / 200 | Left time: 0.11 mins| Loss: 136.7667Pretraining stage:  |################                | 106 / 200 | Left time: 0.11 mins| Loss: 136.3076Pretraining stage:  |#################               | 107 / 200 | Left time: 0.11 mins| Loss: 135.9895Pretraining stage:  |#################               | 108 / 200 | Left time: 0.11 mins| Loss: 135.4324Pretraining stage:  |#################               | 109 / 200 | Left time: 0.10 mins| Loss: 135.8008Pretraining stage:  |#################               | 110 / 200 | Left time: 0.10 mins| Loss: 136.6263Pretraining stage:  |#################               | 111 / 200 | Left time: 0.10 mins| Loss: 135.9354Pretraining stage:  |#################               | 112 / 200 | Left time: 0.10 mins| Loss: 135.5679Pretraining stage:  |##################              | 113 / 200 | Left time: 0.10 mins| Loss: 135.5070Pretraining stage:  |##################              | 114 / 200 | Left time: 0.10 mins| Loss: 136.8712Pretraining stage:  |##################              | 115 / 200 | Left time: 0.10 mins| Loss: 135.6831Pretraining stage:  |##################              | 116 / 200 | Left time: 0.10 mins| Loss: 136.5300Pretraining stage:  |##################              | 117 / 200 | Left time: 0.09 mins| Loss: 136.0943Pretraining stage:  |##################              | 118 / 200 | Left time: 0.09 mins| Loss: 136.1507Pretraining stage:  |###################             | 119 / 200 | Left time: 0.09 mins| Loss: 135.3275Pretraining stage:  |###################             | 120 / 200 | Left time: 0.09 mins| Loss: 135.7606Pretraining stage:  |###################             | 121 / 200 | Left time: 0.09 mins| Loss: 135.6240Pretraining stage:  |###################             | 122 / 200 | Left time: 0.09 mins| Loss: 135.2140Pretraining stage:  |###################             | 123 / 200 | Left time: 0.09 mins| Loss: 135.6308Pretraining stage:  |###################             | 124 / 200 | Left time: 0.09 mins| Loss: 135.2934Pretraining stage:  |####################            | 125 / 200 | Left time: 0.09 mins| Loss: 136.1225Pretraining stage:  |####################            | 126 / 200 | Left time: 0.09 mins| Loss: 135.8676Pretraining stage:  |####################            | 127 / 200 | Left time: 0.08 mins| Loss: 135.7102Pretraining stage:  |####################            | 128 / 200 | Left time: 0.08 mins| Loss: 136.2366Pretraining stage:  |####################            | 129 / 200 | Left time: 0.08 mins| Loss: 136.2051Pretraining stage:  |####################            | 130 / 200 | Left time: 0.08 mins| Loss: 135.6185Pretraining stage:  |####################            | 131 / 200 | Left time: 0.08 mins| Loss: 134.8715Pretraining stage:  |#####################           | 132 / 200 | Left time: 0.08 mins| Loss: 135.4271Pretraining stage:  |#####################           | 133 / 200 | Left time: 0.08 mins| Loss: 135.4142Pretraining stage:  |#####################           | 134 / 200 | Left time: 0.08 mins| Loss: 136.1575Pretraining stage:  |#####################           | 135 / 200 | Left time: 0.07 mins| Loss: 134.5648Pretraining stage:  |#####################           | 136 / 200 | Left time: 0.07 mins| Loss: 135.8445Pretraining stage:  |#####################           | 137 / 200 | Left time: 0.07 mins| Loss: 135.9624Pretraining stage:  |######################          | 138 / 200 | Left time: 0.07 mins| Loss: 136.1918Pretraining stage:  |######################          | 139 / 200 | Left time: 0.07 mins| Loss: 135.5736Pretraining stage:  |######################          | 140 / 200 | Left time: 0.07 mins| Loss: 135.9707Pretraining stage:  |######################          | 141 / 200 | Left time: 0.07 mins| Loss: 135.5835Pretraining stage:  |######################          | 142 / 200 | Left time: 0.07 mins| Loss: 135.4818Pretraining stage:  |######################          | 143 / 200 | Left time: 0.07 mins| Loss: 135.7358Pretraining stage:  |#######################         | 144 / 200 | Left time: 0.06 mins| Loss: 135.2737Pretraining stage:  |#######################         | 145 / 200 | Left time: 0.06 mins| Loss: 135.5727Pretraining stage:  |#######################         | 146 / 200 | Left time: 0.06 mins| Loss: 134.5617Pretraining stage:  |#######################         | 147 / 200 | Left time: 0.06 mins| Loss: 135.6571Pretraining stage:  |#######################         | 148 / 200 | Left time: 0.06 mins| Loss: 136.1767Pretraining stage:  |#######################         | 149 / 200 | Left time: 0.06 mins| Loss: 135.6125Pretraining stage:  |########################        | 150 / 200 | Left time: 0.06 mins| Loss: 134.9379Pretraining stage:  |########################        | 151 / 200 | Left time: 0.06 mins| Loss: 135.0307Pretraining stage:  |########################        | 152 / 200 | Left time: 0.06 mins| Loss: 135.6807Pretraining stage:  |########################        | 153 / 200 | Left time: 0.05 mins| Loss: 133.8912Pretraining stage:  |########################        | 154 / 200 | Left time: 0.05 mins| Loss: 133.8438Pretraining stage:  |########################        | 155 / 200 | Left time: 0.05 mins| Loss: 135.4994Pretraining stage:  |########################        | 156 / 200 | Left time: 0.05 mins| Loss: 134.7902Pretraining stage:  |#########################       | 157 / 200 | Left time: 0.05 mins| Loss: 133.9487Pretraining stage:  |#########################       | 158 / 200 | Left time: 0.05 mins| Loss: 133.5589Pretraining stage:  |#########################       | 159 / 200 | Left time: 0.05 mins| Loss: 135.4386Pretraining stage:  |#########################       | 160 / 200 | Left time: 0.05 mins| Loss: 135.0551Pretraining stage:  |#########################       | 161 / 200 | Left time: 0.05 mins| Loss: 135.8916Pretraining stage:  |#########################       | 162 / 200 | Left time: 0.04 mins| Loss: 134.6377Pretraining stage:  |##########################      | 163 / 200 | Left time: 0.04 mins| Loss: 134.9729Pretraining stage:  |##########################      | 164 / 200 | Left time: 0.04 mins| Loss: 135.2270Pretraining stage:  |##########################      | 165 / 200 | Left time: 0.04 mins| Loss: 135.3663Pretraining stage:  |##########################      | 166 / 200 | Left time: 0.04 mins| Loss: 135.2810Pretraining stage:  |##########################      | 167 / 200 | Left time: 0.04 mins| Loss: 134.2292Pretraining stage:  |##########################      | 168 / 200 | Left time: 0.04 mins| Loss: 135.6507Pretraining stage:  |###########################     | 169 / 200 | Left time: 0.04 mins| Loss: 135.5743Pretraining stage:  |###########################     | 170 / 200 | Left time: 0.04 mins| Loss: 134.1335Pretraining stage:  |###########################     | 171 / 200 | Left time: 0.03 mins| Loss: 135.1701Pretraining stage:  |###########################     | 172 / 200 | Left time: 0.03 mins| Loss: 134.6620Pretraining stage:  |###########################     | 173 / 200 | Left time: 0.03 mins| Loss: 134.6839Pretraining stage:  |###########################     | 174 / 200 | Left time: 0.03 mins| Loss: 135.8047Pretraining stage:  |############################    | 175 / 200 | Left time: 0.03 mins| Loss: 134.2689Pretraining stage:  |############################    | 176 / 200 | Left time: 0.03 mins| Loss: 133.9092Pretraining stage:  |############################    | 177 / 200 | Left time: 0.03 mins| Loss: 134.7394Pretraining stage:  |############################    | 178 / 200 | Left time: 0.03 mins| Loss: 133.9425Pretraining stage:  |############################    | 179 / 200 | Left time: 0.02 mins| Loss: 134.8596Pretraining stage:  |############################    | 180 / 200 | Left time: 0.02 mins| Loss: 133.4700Pretraining stage:  |############################    | 181 / 200 | Left time: 0.02 mins| Loss: 134.3168Pretraining stage:  |#############################   | 182 / 200 | Left time: 0.02 mins| Loss: 133.5764Pretraining stage:  |#############################   | 183 / 200 | Left time: 0.02 mins| Loss: 133.7412Pretraining stage:  |#############################   | 184 / 200 | Left time: 0.02 mins| Loss: 134.5514Pretraining stage:  |#############################   | 185 / 200 | Left time: 0.02 mins| Loss: 133.3017Pretraining stage:  |#############################   | 186 / 200 | Left time: 0.02 mins| Loss: 133.1521Pretraining stage:  |#############################   | 187 / 200 | Left time: 0.02 mins| Loss: 133.5856Pretraining stage:  |##############################  | 188 / 200 | Left time: 0.01 mins| Loss: 133.4257Pretraining stage:  |##############################  | 189 / 200 | Left time: 0.01 mins| Loss: 133.5980Pretraining stage:  |##############################  | 190 / 200 | Left time: 0.01 mins| Loss: 133.3357Pretraining stage:  |##############################  | 191 / 200 | Left time: 0.01 mins| Loss: 134.0027Pretraining stage:  |##############################  | 192 / 200 | Left time: 0.01 mins| Loss: 135.1690Pretraining stage:  |##############################  | 193 / 200 | Left time: 0.01 mins| Loss: 134.4345Pretraining stage:  |############################### | 194 / 200 | Left time: 0.01 mins| Loss: 133.5521Pretraining stage:  |############################### | 195 / 200 | Left time: 0.01 mins| Loss: 134.1712Pretraining stage:  |############################### | 196 / 200 | Left time: 0.01 mins| Loss: 132.7898Pretraining stage:  |############################### | 197 / 200 | Left time: 0.00 mins| Loss: 133.8654Pretraining stage:  |############################### | 198 / 200 | Left time: 0.00 mins| Loss: 133.3790Pretraining stage:  |############################### | 199 / 200 | Left time: 0.00 mins| Loss: 133.5972Pretraining stage:  |################################| 200 / 200 | Left time: 0.00 mins| Loss: 132.9007
Major training stage:  |                                | 1 / 200 | Loss: 3.7789Major training stage:  |                                | 2 / 200 | Loss: 3.7356Major training stage:  |                                | 3 / 200 | Loss: 3.6705Major training stage:  |                                | 4 / 200 | Loss: 3.5930Major training stage:  |                                | 5 / 200 | Loss: 3.6143Major training stage:  |                                | 6 / 200 | Loss: 3.5569Major training stage:  |#                               | 7 / 200 | Loss: 3.5879Major training stage:  |#                               | 8 / 200 | Loss: 3.5100Major training stage:  |#                               | 9 / 200 | Loss: 3.5395Major training stage:  |#                               | 10 / 200 | Loss: 3.4912Major training stage:  |#                               | 11 / 200 | Loss: 3.4756Major training stage:  |#                               | 12 / 200 | Loss: 3.4587Major training stage:  |##                              | 13 / 200 | Loss: 3.4474Major training stage:  |##                              | 14 / 200 | Loss: 3.4603Major training stage:  |##                              | 15 / 200 | Loss: 3.4441Major training stage:  |##                              | 16 / 200 | Loss: 3.3852Major training stage:  |##                              | 17 / 200 | Loss: 3.4848Major training stage:  |##                              | 18 / 200 | Loss: 3.4610Major training stage:  |###                             | 19 / 200 | Loss: 3.3835Major training stage:  |###                             | 20 / 200 | Loss: 3.4199Major training stage:  |###                             | 21 / 200 | Loss: 3.4546Major training stage:  |###                             | 22 / 200 | Loss: 3.3995Major training stage:  |###                             | 23 / 200 | Loss: 3.4276Major training stage:  |###                             | 24 / 200 | Loss: 3.3905Major training stage:  |####                            | 25 / 200 | Loss: 3.3699Major training stage:  |####                            | 26 / 200 | Loss: 3.4250Major training stage:  |####                            | 27 / 200 | Loss: 3.4196Major training stage:  |####                            | 28 / 200 | Loss: 3.3529Major training stage:  |####                            | 29 / 200 | Loss: 3.3748Major training stage:  |####                            | 30 / 200 | Loss: 3.3551Major training stage:  |####                            | 31 / 200 | Loss: 3.4086Major training stage:  |#####                           | 32 / 200 | Loss: 3.3344Major training stage:  |#####                           | 33 / 200 | Loss: 3.3278Major training stage:  |#####                           | 34 / 200 | Loss: 3.3573Major training stage:  |#####                           | 35 / 200 | Loss: 3.3697Major training stage:  |#####                           | 36 / 200 | Loss: 3.3596Major training stage:  |#####                           | 37 / 200 | Loss: 3.3593Major training stage:  |######                          | 38 / 200 | Loss: 3.3094Major training stage:  |######                          | 39 / 200 | Loss: 3.3212Major training stage:  |######                          | 40 / 200 | Loss: 3.3259Major training stage:  |######                          | 41 / 200 | Loss: 3.3743Major training stage:  |######                          | 42 / 200 | Loss: 3.3806Major training stage:  |######                          | 43 / 200 | Loss: 3.3710Major training stage:  |#######                         | 44 / 200 | Loss: 3.3468Major training stage:  |#######                         | 45 / 200 | Loss: 3.4508Major training stage:  |#######                         | 46 / 200 | Loss: 3.3969Major training stage:  |#######                         | 47 / 200 | Loss: 3.3724Major training stage:  |#######                         | 48 / 200 | Loss: 3.3885Major training stage:  |#######                         | 49 / 200 | Loss: 3.3253Major training stage:  |########                        | 50 / 200 | Loss: 3.3677Major training stage:  |########                        | 51 / 200 | Loss: 3.3270Major training stage:  |########                        | 52 / 200 | Loss: 3.3448Major training stage:  |########                        | 53 / 200 | Loss: 3.3219Major training stage:  |########                        | 54 / 200 | Loss: 3.3518Major training stage:  |########                        | 55 / 200 | Loss: 3.3476Major training stage:  |########                        | 56 / 200 | Loss: 3.3289Major training stage:  |#########                       | 57 / 200 | Loss: 3.2976Major training stage:  |#########                       | 58 / 200 | Loss: 3.3590Major training stage:  |#########                       | 59 / 200 | Loss: 3.3839Major training stage:  |#########                       | 60 / 200 | Loss: 3.2857Major training stage:  |#########                       | 61 / 200 | Loss: 3.3461Major training stage:  |#########                       | 62 / 200 | Loss: 3.4394Major training stage:  |##########                      | 63 / 200 | Loss: 3.3666Major training stage:  |##########                      | 64 / 200 | Loss: 3.3536Major training stage:  |##########                      | 65 / 200 | Loss: 3.4162Major training stage:  |##########                      | 66 / 200 | Loss: 3.3246Major training stage:  |##########                      | 67 / 200 | Loss: 3.3448Major training stage:  |##########                      | 68 / 200 | Loss: 3.3526Major training stage:  |###########                     | 69 / 200 | Loss: 3.3807Major training stage:  |###########                     | 70 / 200 | Loss: 3.3257Major training stage:  |###########                     | 71 / 200 | Loss: 3.3205Major training stage:  |###########                     | 72 / 200 | Loss: 3.3203Major training stage:  |###########                     | 73 / 200 | Loss: 3.4069Major training stage:  |###########                     | 74 / 200 | Loss: 3.2957Major training stage:  |############                    | 75 / 200 | Loss: 3.4458Major training stage:  |############                    | 76 / 200 | Loss: 3.3337Major training stage:  |############                    | 77 / 200 | Loss: 3.3245Major training stage:  |############                    | 78 / 200 | Loss: 3.3273Major training stage:  |############                    | 79 / 200 | Loss: 3.3286Major training stage:  |############                    | 80 / 200 | Loss: 3.3017Major training stage:  |############                    | 81 / 200 | Loss: 3.4296Major training stage:  |#############                   | 82 / 200 | Loss: 3.3306Major training stage:  |#############                   | 83 / 200 | Loss: 3.3285Major training stage:  |#############                   | 84 / 200 | Loss: 3.3914Major training stage:  |#############                   | 85 / 200 | Loss: 3.3310Major training stage:  |#############                   | 86 / 200 | Loss: 3.3480Major training stage:  |#############                   | 87 / 200 | Loss: 3.3249Major training stage:  |##############                  | 88 / 200 | Loss: 3.4002Major training stage:  |##############                  | 89 / 200 | Loss: 3.3917Major training stage:  |##############                  | 90 / 200 | Loss: 3.3631Major training stage:  |##############                  | 91 / 200 | Loss: 3.3676Major training stage:  |##############                  | 92 / 200 | Loss: 3.3397Major training stage:  |##############                  | 93 / 200 | Loss: 3.3608Major training stage:  |###############                 | 94 / 200 | Loss: 3.3679Major training stage:  |###############                 | 95 / 200 | Loss: 3.3426Major training stage:  |###############                 | 96 / 200 | Loss: 3.3517Major training stage:  |###############                 | 97 / 200 | Loss: 3.3612Major training stage:  |###############                 | 98 / 200 | Loss: 3.3401Major training stage:  |###############                 | 99 / 200 | Loss: 3.3586Major training stage:  |################                | 100 / 200 | Loss: 3.3394Major training stage:  |################                | 101 / 200 | Loss: 3.3595Major training stage:  |################                | 102 / 200 | Loss: 3.3514Major training stage:  |################                | 103 / 200 | Loss: 3.3341Major training stage:  |################                | 104 / 200 | Loss: 3.3237Major training stage:  |################                | 105 / 200 | Loss: 3.3324Major training stage:  |################                | 106 / 200 | Loss: 3.3726Major training stage:  |#################               | 107 / 200 | Loss: 3.3080Major training stage:  |#################               | 108 / 200 | Loss: 3.3490Major training stage:  |#################               | 109 / 200 | Loss: 3.3032Major training stage:  |#################               | 110 / 200 | Loss: 3.3084Major training stage:  |#################               | 111 / 200 | Loss: 3.3010Major training stage:  |#################               | 112 / 200 | Loss: 3.3134Major training stage:  |##################              | 113 / 200 | Loss: 3.3340Major training stage:  |##################              | 114 / 200 | Loss: 3.2996Major training stage:  |##################              | 115 / 200 | Loss: 3.3377Major training stage:  |##################              | 116 / 200 | Loss: 3.3759Major training stage:  |##################              | 117 / 200 | Loss: 3.3639Major training stage:  |##################              | 118 / 200 | Loss: 3.3181Major training stage:  |###################             | 119 / 200 | Loss: 3.3564Major training stage:  |###################             | 120 / 200 | Loss: 3.3103Major training stage:  |###################             | 121 / 200 | Loss: 3.3625Major training stage:  |###################             | 122 / 200 | Loss: 3.3307Major training stage:  |###################             | 123 / 200 | Loss: 3.3317Major training stage:  |###################             | 124 / 200 | Loss: 3.3046Major training stage:  |####################            | 125 / 200 | Loss: 3.3207Major training stage:  |####################            | 126 / 200 | Loss: 3.3030Major training stage:  |####################            | 127 / 200 | Loss: 3.3118Major training stage:  |####################            | 128 / 200 | Loss: 3.3824Major training stage:  |####################            | 129 / 200 | Loss: 3.3296Major training stage:  |####################            | 130 / 200 | Loss: 3.2973Major training stage:  |####################            | 131 / 200 | Loss: 3.2975Major training stage:  |#####################           | 132 / 200 | Loss: 3.3331Major training stage:  |#####################           | 133 / 200 | Loss: 3.2932Major training stage:  |#####################           | 134 / 200 | Loss: 3.3788Major training stage:  |#####################           | 135 / 200 | Loss: 3.3616Major training stage:  |#####################           | 136 / 200 | Loss: 3.3388Major training stage:  |#####################           | 137 / 200 | Loss: 3.3118Major training stage:  |######################          | 138 / 200 | Loss: 3.2963Major training stage:  |######################          | 139 / 200 | Loss: 3.3009Major training stage:  |######################          | 140 / 200 | Loss: 3.2866Major training stage:  |######################          | 141 / 200 | Loss: 3.3335Major training stage:  |######################          | 142 / 200 | Loss: 3.3679Major training stage:  |######################          | 143 / 200 | Loss: 3.3230Major training stage:  |#######################         | 144 / 200 | Loss: 3.3052Major training stage:  |#######################         | 145 / 200 | Loss: 3.3003Major training stage:  |#######################         | 146 / 200 | Loss: 3.2864Major training stage:  |#######################         | 147 / 200 | Loss: 3.2957Major training stage:  |#######################         | 148 / 200 | Loss: 3.2975Major training stage:  |#######################         | 149 / 200 | Loss: 3.3504Major training stage:  |########################        | 150 / 200 | Loss: 3.2939Major training stage:  |########################        | 151 / 200 | Loss: 3.2833Major training stage:  |########################        | 152 / 200 | Loss: 3.3526Major training stage:  |########################        | 153 / 200 | Loss: 3.2966Major training stage:  |########################        | 154 / 200 | Loss: 3.3575Major training stage:  |########################        | 155 / 200 | Loss: 3.3735Major training stage:  |########################        | 156 / 200 | Loss: 3.3536Major training stage:  |#########################       | 157 / 200 | Loss: 3.3109Major training stage:  |#########################       | 158 / 200 | Loss: 3.3319Major training stage:  |#########################       | 159 / 200 | Loss: 3.3533Major training stage:  |#########################       | 160 / 200 | Loss: 3.3255Major training stage:  |#########################       | 161 / 200 | Loss: 3.3538Major training stage:  |#########################       | 162 / 200 | Loss: 3.3502Major training stage:  |##########################      | 163 / 200 | Loss: 3.3530Major training stage:  |##########################      | 164 / 200 | Loss: 3.3616Major training stage:  |##########################      | 165 / 200 | Loss: 3.3562Major training stage:  |##########################      | 166 / 200 | Loss: 3.4000Major training stage:  |##########################      | 167 / 200 | Loss: 3.3221Major training stage:  |##########################      | 168 / 200 | Loss: 3.3322Major training stage:  |###########################     | 169 / 200 | Loss: 3.3556Major training stage:  |###########################     | 170 / 200 | Loss: 3.4207Major training stage:  |###########################     | 171 / 200 | Loss: 3.3413Major training stage:  |###########################     | 172 / 200 | Loss: 3.3195Major training stage:  |###########################     | 173 / 200 | Loss: 3.3114Major training stage:  |###########################     | 174 / 200 | Loss: 3.3103Major training stage:  |############################    | 175 / 200 | Loss: 3.3596Major training stage:  |############################    | 176 / 200 | Loss: 3.3691Major training stage:  |############################    | 177 / 200 | Loss: 3.3083Major training stage:  |############################    | 178 / 200 | Loss: 3.3010Major training stage:  |############################    | 179 / 200 | Loss: 3.3097Major training stage:  |############################    | 180 / 200 | Loss: 3.3506Major training stage:  |############################    | 181 / 200 | Loss: 3.3925Major training stage:  |#############################   | 182 / 200 | Loss: 3.3801Major training stage:  |#############################   | 183 / 200 | Loss: 3.3004Major training stage:  |#############################   | 184 / 200 | Loss: 3.3398Major training stage:  |#############################   | 185 / 200 | Loss: 3.3587Major training stage:  |#############################   | 186 / 200 | Loss: 3.3456Major training stage:  |#############################   | 187 / 200 | Loss: 3.3095Major training stage:  |##############################  | 188 / 200 | Loss: 3.3418Major training stage:  |##############################  | 189 / 200 | Loss: 3.3052Major training stage:  |##############################  | 190 / 200 | Loss: 3.3174Major training stage:  |##############################  | 191 / 200 | Loss: 3.2983Major training stage:  |##############################  | 192 / 200 | Loss: 3.3489Major training stage:  |##############################  | 193 / 200 | Loss: 3.3585Major training stage:  |############################### | 194 / 200 | Loss: 3.3338Major training stage:  |############################### | 195 / 200 | Loss: 3.3496Major training stage:  |############################### | 196 / 200 | Loss: 3.3760Major training stage:  |############################### | 197 / 200 | Loss: 3.3778Major training stage:  |############################### | 198 / 200 | Loss: 3.3359Major training stage:  |############################### | 199 / 200 | Loss: 3.3057Major training stage:  |################################| 200 / 200 | Loss: 3.3714
Execution time: 94.7376 seconds
Current memory usage: 138.6520 MB
Peak memory usage: 719.8051 MB
0.35


Running SpaceFlow...





Epoch 2/1000, Loss: 1.8175216913223267
Epoch 12/1000, Loss: 1.4476211071014404
Epoch 22/1000, Loss: 1.3869928121566772
Epoch 32/1000, Loss: 1.089920163154602
Epoch 42/1000, Loss: 0.7033485174179077
Epoch 52/1000, Loss: 0.5016108751296997
Epoch 62/1000, Loss: 0.3466435372829437
Epoch 72/1000, Loss: 0.2731373608112335
Epoch 82/1000, Loss: 0.23717589676380157
Epoch 92/1000, Loss: 0.1962738037109375
Epoch 102/1000, Loss: 0.22988906502723694
Epoch 112/1000, Loss: 0.28275325894355774
Epoch 122/1000, Loss: 0.17439985275268555
Epoch 132/1000, Loss: 0.1629830300807953
Epoch 142/1000, Loss: 0.14593958854675293
Epoch 152/1000, Loss: 0.14059200882911682
Epoch 162/1000, Loss: 0.14271506667137146
Epoch 172/1000, Loss: 0.12775471806526184
Epoch 182/1000, Loss: 0.13134843111038208
Epoch 192/1000, Loss: 0.13558292388916016
Epoch 202/1000, Loss: 0.12078675627708435
Epoch 212/1000, Loss: 0.1155783012509346
Epoch 222/1000, Loss: 0.10976329445838928
Epoch 232/1000, Loss: 0.08983641117811203
Epoch 242/1000, Loss: 0.10098768770694733
Epoch 252/1000, Loss: 0.10027626156806946
Epoch 262/1000, Loss: 0.0949523076415062
Epoch 272/1000, Loss: 0.10773731768131256
Epoch 282/1000, Loss: 0.09496809542179108
Epoch 292/1000, Loss: 0.09218844771385193
Epoch 302/1000, Loss: 0.0864875540137291
Epoch 312/1000, Loss: 0.09661123156547546
Epoch 322/1000, Loss: 0.0845833271741867
Epoch 332/1000, Loss: 0.08694007992744446
Epoch 342/1000, Loss: 0.08815906941890717
Epoch 352/1000, Loss: 0.08078964054584503
Epoch 362/1000, Loss: 0.08869213610887527
Epoch 372/1000, Loss: 0.07702231407165527
Epoch 382/1000, Loss: 0.07355507463216782
Epoch 392/1000, Loss: 0.07877019047737122
Epoch 402/1000, Loss: 0.06584325432777405
Epoch 412/1000, Loss: 0.07256820797920227
Epoch 422/1000, Loss: 0.07181894034147263
Epoch 432/1000, Loss: 0.1189327985048294
Epoch 442/1000, Loss: 0.09539928287267685
Epoch 452/1000, Loss: 0.3382166624069214
Epoch 462/1000, Loss: 0.17210161685943604
Training complete!
Embedding is saved at ./embedding.tsv
Execution time: 74.7579 seconds
Current memory usage: 79.3985 MB
Peak memory usage: 160.3217 MB
Performing domain segmentation
Segmentation complete, domain labels of cells or spots saved at ./dlpfc/dlpfc_domains_{}.csv !
Plotting complete, segmentation figure saved at ./dlpfc/dlpfc_domain_segmentation_{}.pdf !
Running evaluation pipeline...
gound truth was detcted in anndata and will be used for evaluation
Saving ground_truth cluster plot to /storage-large/homedirs/nndgpl46/MultimetricST/multimetricST_outputs/figures/151673/
ARI:  0.3109
AMI:  0.4813
Purity Score:  0.5471
Homogeneity Score:  0.4935
Completeness Score:  0.4728
V-Measure Score:  0.4829
Silhouette Spatial Coefficient:  0.068
SSC average dispersion: 0.0093
Silhouette Coefficient:  0.0756
Davies Bouldin Index:  4.5644
CHAOS:  6.0055
PAS:  0.0088
ASW:  0.2223
Saving CCST cluster plot to /storage-large/homedirs/nndgpl46/MultimetricST/multimetricST_outputs/figures/151673/
ARI:  0.4596
AMI:  0.6589
Purity Score:  0.7332
Homogeneity Score:  0.656
Completeness Score:  0.664
V-Measure Score:  0.66
Silhouette Spatial Coefficient:  0.048
SSC average dispersion: 0.0238
Silhouette Coefficient:  0.0632
Davies Bouldin Index:  4.4025
CHAOS:  6.0137
PAS:  0.0376
ASW:  0.017
Saving conST cluster plot to /storage-large/homedirs/nndgpl46/MultimetricST/multimetricST_outputs/figures/151673/
ARI:  0.2536
AMI:  0.4894
Purity Score:  0.3611
Homogeneity Score:  0.6102
Completeness Score:  0.4131
V-Measure Score:  0.4927
Silhouette Spatial Coefficient:  -0.1123
SSC average dispersion: 0.1384
Silhouette Coefficient:  -0.022
Davies Bouldin Index:  4.3272
CHAOS:  6.1387
PAS:  0.0739
ASW:  -0.0186
Saving SpaceFlow cluster plot to /storage-large/homedirs/nndgpl46/MultimetricST/multimetricST_outputs/figures/151673/
